# ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
import streamlit as st    # ‡πÉ‡∏ä‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏ö‡∏ö interactive
import pandas as pd       # ‡πÉ‡∏ä‡πâ‡πÇ‡∏´‡∏•‡∏î/‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á Excel

# --------------------- 1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö ---------------------
st.set_page_config(page_title="‡πÅ‡∏ú‡∏ô‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏™‡∏ß‡∏¥‡∏ï", layout="wide")  # ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ó‡πá‡∏ö‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏≠
st.title("üá®üá≠ ‡πÅ‡∏ú‡∏ô‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏™‡∏ß‡∏¥‡∏ï‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏ô‡∏î‡πå‡∏Ç‡∏≠‡∏á‡∏û‡∏µ‡πà‡∏≠‡∏∏‡πä‡∏Å & ‡∏ö‡∏¥‡∏ß ü§ç")  # ‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á
st.markdown("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏î‡∏π‡πÅ‡∏ú‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞")                # ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ï‡πâ‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á

# --------------------- 2. ‡πÇ‡∏´‡∏•‡∏î Excel ---------------------
excel_path = "Plan/Swiss_plan_app.xlsx"  # ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏ü‡∏•‡πå

# ‡πÇ‡∏´‡∏•‡∏î Excel ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏µ‡∏ó‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤
xls = pd.ExcelFile(excel_path)           # pd.ExcelFile ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏õ‡∏¥‡∏î Excel ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
sheet_names = xls.sheet_names            # ‡πÄ‡∏≠‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡∏ó‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ (Day1, Day2, ...)

# --------------------- 3. ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô ---------------------
selected_day = st.selectbox("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô", sheet_names)  # ‡∏Å‡∏•‡πà‡∏≠‡∏á dropdown ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô

# --------------------- 4. ‡∏≠‡πà‡∏≤‡∏ô‡∏ä‡∏µ‡∏ó‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ---------------------
df = pd.read_excel(excel_path, sheet_name=selected_day)

# ‡∏•‡πâ‡∏≤‡∏á space ‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ö‡∏ö " Time " ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)
df.columns = df.columns.str.strip()

# --------------------- 5. ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô ---------------------
st.markdown(f"### üìÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö {selected_day}")

# --------------------- 6. CSS ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡πâ‡∏ô Timeline ---------------------
timeline_css = """
<style>
.timeline {
    position: relative;
    max-width: 1200px;
    margin: 50px auto;
}
.timeline::after {
    content: '';
    position: absolute;
    width: 6px;
    background-color: pink;
    top: 0;
    bottom: 0;
    left: 50%;
    margin-left: -3px;
}
.timeline-item {
    padding: 10px 30px;
    position: relative;
    width: 50%;
}
.timeline-left {
    left: 0;
}
.timeline-right {
    left: 50%;
}
.timeline-box {
    padding: 15px;
    background: white;
    color: black;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    position: relative;
}
.timeline-left .timeline-box {
    margin-left: auto;
    text-align: right;
}
.timeline-right .timeline-box {
    margin-right: auto;
    text-align: left;
}
</style>
"""

# --------------------- 7. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° HTML ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö timeline ---------------------
timeline_html = '<div class="timeline">'  # ‡πÄ‡∏£‡∏¥‡πà‡∏° div ‡∏´‡∏•‡∏±‡∏Å

# --------------------- 8. ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á timeline ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á ---------------------
for i, row in df.iterrows():  # .iterrows() = ‡∏ß‡∏ô‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ñ‡∏ß‡πÉ‡∏ô DataFrame

    # --- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ: pd.isna() ---
    # ‡πÉ‡∏ä‡πâ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô cell ‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á (NaN) ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡πà‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô pd.isna("abc") = False, pd.isna(None) = True

    if pd.isna(row['Time']) and pd.isna(row['Location']) and pd.isna(row['Destination']) and pd.isna(row['Activity']):
        continue  # ‡∏Ç‡πâ‡∏≤‡∏°‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏•‡∏¢

    # --- ‡∏™‡∏•‡∏±‡∏ö‡∏ã‡πâ‡∏≤‡∏¢‡∏Ç‡∏ß‡∏≤‡πÅ‡∏ö‡∏ö‡∏ü‡∏±‡∏ô‡∏õ‡∏•‡∏≤ ---
    # i ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏Ç index 0, 1, 2, ...
    # ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏π‡πà (0, 2, 4) ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ã‡πâ‡∏≤‡∏¢ / ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏µ‡πà (1, 3, 5) ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡∏ß‡∏≤
    side = "timeline-left" if i % 2 == 0 else "timeline-right"

    # --- ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML ‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ñ‡∏ß ---
    timeline_html += f"""
    <div class="timeline-item {side}">
        <div class="timeline-box">
            <b>üïí ‡πÄ‡∏ß‡∏•‡∏≤:</b> {row['Time'] or '-'}<br>
            <b>üìç ‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á:</b> {row['Location'] or '-'}<br>
            <b>üèÅ ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á:</b> {row['Destination'] or '-'}<br>
            <b>üéØ ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°:</b> {row['Activity'] or '-'}
        </div>
    </div>
    """

# ‡∏õ‡∏¥‡∏î tag div ‡∏´‡∏•‡∏±‡∏Å timeline
timeline_html += "</div>"

# --------------------- 9. ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ô‡πÄ‡∏ß‡πá‡∏ö ---------------------
# unsafe_allow_html=True ‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏´‡πâ HTML & CSS ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÑ‡∏î‡πâ
st.markdown(timeline_css + timeline_html, unsafe_allow_html=True)
